{"version":3,"file":"extension.js","mappings":"iCAAAA,EAAOC,QAAUC,QAAQ,S,SCAzBF,EAAOC,QAAUC,QAAQ,gB,SCAzBF,EAAOC,QAAUC,QAAQ,O,GCCrBC,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAaL,QAGrB,IAAID,EAASG,EAAyBE,GAAY,CAGjDJ,QAAS,CAAC,GAOX,OAHAO,EAAoBH,GAAUL,EAAQA,EAAOC,QAASG,GAG/CJ,EAAOC,OACf,C,4GClBA,oBAAyBQ,GACrBC,QAAQC,IAAI,uCAGZF,EAAQG,cAAcC,KAClBC,EAAOC,UAAUC,4BAA4B,OAAQ,IAAIC,EAA8B,CACnFC,wBAAyBD,EAA2BC,2BAK5DT,EAAQG,cAAcC,KAClBC,EAAOK,SAASC,gBAAgB,4BAA6BC,GAErE,EAEA,wBAA+B,EApB/B,eACA,SACA,SAuBA,MAAaJ,EACFK,+BAA0C,CAC7CR,EAAOS,eAAeC,UAGnB,kBAAAC,CACHC,EACAC,EACAlB,EACAmB,GAMA,MAAMC,EAAOH,EAASI,OAAOH,EAAMI,MAAMF,MAAMG,KAC/C,GAAKH,EAAKI,SAAS,MAASJ,EAAKI,SAAS,KAK1C,MAAO,CADeC,KAAKC,gBAE/B,CAEQ,aAAAA,GACJ,MAAMC,EAAS,IAAItB,EAAOuB,WAAW,kCAAmCvB,EAAOS,eAAeC,UAO9F,OANAY,EAAOE,QAAU,CACbA,QAAS,4BACTC,MAAO,+BACPC,QAAS,iEAEbJ,EAAOK,aAAc,EACdL,CACX,EAMJM,eAAerB,IACX,MAAMsB,EAAS7B,EAAO8B,OAAOC,iBAC7B,IAAKF,EACD,OAGJ,MAAMjB,EAAWiB,EAAOjB,SAClBoB,EAAWH,EAAOI,UAAUC,OAC5BC,EAAWvB,EAASwB,IAAIC,aAGxBzB,EAAS0B,OAKf,MAAMC,EAAkBvC,EAAOwC,UAAUC,mBAAmB7B,EAASwB,KAK/DM,EAAO,CACT,MALmBH,EACjBI,EAAKC,KAAKL,EAAgBH,IAAIC,OAAQ,MAAO,oBAC7C,cAKF,mBACA,UAAUF,IACV,UAAUH,EAASjB,KAAO,IAC1B,SAASiB,EAASa,UAAY,KAGlC7C,EAAO8B,OAAOgB,aAAa,CACvBC,SAAU/C,EAAOgD,iBAAiBC,aAClCxB,MAAO,gCACPyB,aAAa,GACdtB,MAAOuB,GACC,IAAIC,QAAc,CAACC,EAASC,KAE/BC,EAAGC,SAAS,OAAQd,EAAM,CAAEe,IAAKlB,GAAiBH,IAAIC,QAAUM,EAAKe,QAAQvB,IAAa,CAACwB,EAAOC,EAAQC,KACtG,GAAIF,EAGA,OAFA3D,EAAO8B,OAAOgC,iBAAiB,sBAAsBH,EAAMI,cAAcF,UACzEP,EAAOK,GAIX3D,EAAO8B,OAAOkC,uBAAuB,iDACrCX,QAIhB,CAxFA,8B","sources":["webpack://full-loc-checker/external commonjs \"vscode\"","webpack://full-loc-checker/external node-commonjs \"child_process\"","webpack://full-loc-checker/external node-commonjs \"path\"","webpack://full-loc-checker/webpack/bootstrap","webpack://full-loc-checker/./src/extension.ts"],"sourcesContent":["module.exports = require(\"vscode\");","module.exports = require(\"child_process\");","module.exports = require(\"path\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","import * as vscode from 'vscode';\nimport * as cp from 'child_process';\nimport * as path from 'path';\n\nexport function activate(context: vscode.ExtensionContext) {\n    console.log('Localization Checker is now active!');\n\n    // Register the Quick Fix Provider\n    context.subscriptions.push(\n        vscode.languages.registerCodeActionsProvider('dart', new LocalizationActionProvider(), {\n            providedCodeActionKinds: LocalizationActionProvider.providedCodeActionKinds\n        })\n    );\n\n    // Register the actual command that executes the Dart script\n    context.subscriptions.push(\n        vscode.commands.registerCommand('loc-checker.extractSingle', runExtraction)\n    );\n}\n\nexport function deactivate() { }\n\n/**\n * Provides code actions for Dart string literals.\n */\nexport class LocalizationActionProvider implements vscode.CodeActionProvider {\n    public static readonly providedCodeActionKinds = [\n        vscode.CodeActionKind.QuickFix\n    ];\n\n    public provideCodeActions(\n        document: vscode.TextDocument,\n        range: vscode.Range | vscode.Selection,\n        context: vscode.CodeActionContext,\n        token: vscode.CancellationToken\n    ): vscode.CodeAction[] | undefined {\n\n        // Very basic check if we are on a string literal (we can be more robust using a regex or relying on dart parsing)\n        // For now, let's just surface it anywhere inside a dart file to be safe,\n        // or specifically if the line contains a string.\n        const line = document.lineAt(range.start.line).text;\n        if (!line.includes(\"'\") && !line.includes('\"')) {\n            return;\n        }\n\n        const extractAction = this.createCommand();\n        return [extractAction];\n    }\n\n    private createCommand(): vscode.CodeAction {\n        const action = new vscode.CodeAction('ðŸ’¡ Extract and Translate String', vscode.CodeActionKind.QuickFix);\n        action.command = {\n            command: 'loc-checker.extractSingle',\n            title: 'Extract and Translate String',\n            tooltip: 'Extract this string to ARB and translate it using loc_checker'\n        };\n        action.isPreferred = true;\n        return action;\n    }\n}\n\n/**\n * Runs the loc_checker Dart CLI to extract the string.\n */\nasync function runExtraction() {\n    const editor = vscode.window.activeTextEditor;\n    if (!editor) {\n        return;\n    }\n\n    const document = editor.document;\n    const position = editor.selection.active;\n    const filePath = document.uri.fsPath;\n\n    // Save document before running tool to ensure file matches buffer\n    await document.save();\n\n    // Find the Dart script path\n    // Assuming the extension is running in a subfolder of the main Dart package\n    // or it needs to be configured.\n    const workspaceFolder = vscode.workspace.getWorkspaceFolder(document.uri);\n    const dartScriptPath = workspaceFolder\n        ? path.join(workspaceFolder.uri.fsPath, 'bin', 'loc_checker.dart')\n        : 'loc_checker'; // Fallback to global if installed\n\n    const args = [\n        'run',\n        dartScriptPath, // Fallback if no script found? Actually `dart run bin/loc_checker.dart` is safer\n        '--extract-single',\n        `--file=${filePath}`,\n        `--line=${position.line + 1}`, // line is 0-indexed in VS Code but 1-indexed in loc_checker\n        `--col=${position.character + 1}`\n    ];\n\n    vscode.window.withProgress({\n        location: vscode.ProgressLocation.Notification,\n        title: \"Extracting and Translating...\",\n        cancellable: false\n    }, async (progress) => {\n        return new Promise<void>((resolve, reject) => {\n            // Execute the Dart CLI command\n            cp.execFile('dart', args, { cwd: workspaceFolder?.uri.fsPath || path.dirname(filePath) }, (error, stdout, stderr) => {\n                if (error) {\n                    vscode.window.showErrorMessage(`Extraction failed: ${error.message} \\n ${stderr}`);\n                    reject(error);\n                    return;\n                }\n\n                vscode.window.showInformationMessage('Successfully extracted and translated string!');\n                resolve();\n            });\n        });\n    });\n}"],"names":["module","exports","require","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","context","console","log","subscriptions","push","vscode","languages","registerCodeActionsProvider","LocalizationActionProvider","providedCodeActionKinds","commands","registerCommand","runExtraction","static","CodeActionKind","QuickFix","provideCodeActions","document","range","token","line","lineAt","start","text","includes","this","createCommand","action","CodeAction","command","title","tooltip","isPreferred","async","editor","window","activeTextEditor","position","selection","active","filePath","uri","fsPath","save","workspaceFolder","workspace","getWorkspaceFolder","args","path","join","character","withProgress","location","ProgressLocation","Notification","cancellable","progress","Promise","resolve","reject","cp","execFile","cwd","dirname","error","stdout","stderr","showErrorMessage","message","showInformationMessage"],"sourceRoot":""}